<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kochi Metro Rail Document Management</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
    
   
    /* Updated color theme */
    body {
        background-color: #0B3C46;
        color: #FFDF00;
    }
    
    /* Header styles */
    header {
        background-color: #1A1F24;
        border-bottom: 1px solid #0B3C46;
    }
    
    header h1, 
    header .text-gray-600,
    header .text-gray-400 {
        color: #FFDF00 !important;
    }
    
    header input {
        background-color: #1A1F24;
        border-color: #0B3C46;
        color: #FFDF00;
    }
    
    header input::placeholder {
        color: #8B8B66;
    }
    
    /* Sidebar styles */
    .sidebar {
        background-color: #1A1F24;
       
    }
    
    .sidebar a,
    .sidebar .text-gray-600,
    .sidebar .text-gray-500 {
        color: #FFDF00 !important;
    }
    
    .sidebar a:hover {
        background-color: #0B3C46 !important;
    }
    
    .sidebar .bg-blue-100 {
        background-color: #0B3C46;
    }
    
    .sidebar .text-blue-700 {
        color: #FFDF00 !important;
    }
    
    /* Main content styles */
    .main-content {
        margin-left: 130px;
        background-color: #0B3C46;
    }
    
    .main-content .text-gray-800,
    .main-content .text-gray-600,
    .main-content .text-gray-900 {
        color: #FFDF00 !important;
    }
    
    /* Card and table styles */
    .bg-white {
        background-color: #1A1F24 !important;
    }
    
    .bg-gray-50 {
        background-color: #0B3C46 !important;
    }
    
    .bg-blue-100 {
        background-color: #0B3C46 !important;
    }
    
    .text-gray-500,
    .text-gray-700 {
        color: #FFDF00 !important;
    }
    
    /* Upload area */
    .upload-area {
        border-color: #2D3843;
        background-color: #1A1F24;
    }
    
    .upload-area.dragover {
        border-color: #FFDF00;
        background-color: #2D3843;
    }
    
    /* Table styles */
    .divide-gray-200 > :not([hidden]) ~ :not([hidden]) {
        border-color: #0B3C46;
    }
    
    .bg-gray-50 {
        background-color: #0B3C46 !important;
    }
    
    /* Hover effects */
    .hover\:bg-gray-50:hover {
        background-color: #2D3843 !important;
    }
    
    /* Department colors */
    .department-safety {
        border-left: 4px solid #E53E3E;
    }
    
    .department-finance {
        border-left: 4px solid #38A169;
    }
    
    .department-engineering {
        border-left: 4px solid #3182CE;
    }
    
    .department-pr {
        border-left: 4px solid #D69E2E;
    }
    
    .department-general {
        border-left: 4px solid #718096;
    }
    
    /* Button styles */
    button {
        color: #FFDF00;
    }
    
    #downloadPdf {
        background-color: #2D3843;
        border: 1px solid #FFDF00;
    }
    
    #downloadPdf:hover {
        background-color: #3D4853;
    }
    
    /* SVG icon colors */
    svg.text-gray-400,
    svg.text-blue-600,
    svg.text-red-600 {
        color: #FFDF00 !important;
    }
    
    /* Loading spinner */
    .animate-spin {
        border-color: #FFDF00 transparent #FFDF00 transparent !important;
    }
    
    /* Summary points */
    .summary-point:before {
        color: #FFDF00;
    }
    
    /* Keyword tags */
    .bg-blue-100 {
        background-color: #2D3843 !important;
    }
    
    .text-blue-800 {
        color: #FFDF00 !important;
    }

    
    /* ... (rest of the CSS code from the previous answer) ... */
    
    /* Keep the original media queries and other styles */
    @media (max-width: 768px) {
        .sidebar {
            transform: translateX(-100%);
            position: fixed;
            z-index: 50;
            height: 100vh;
        }
        
        .sidebar.active {
            transform: translateX(0);
        }
        
        .main-content {
            width: 100%;
        }
    }
    
    .summary-point {
        margin-bottom: 0.5rem;
        padding-left: 1rem;
        position: relative;
    }
    
    .summary-point:before {
        content: "•";
        position: absolute;
        left: 0;
        color: #FFDF00;
    }

        
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
                position: fixed;
                z-index: 50;
                height: 100vh;
            }
            
            .sidebar.active {
                transform: translateX(0);
            }
            
            .main-content {
                width: 100%;
            }
        }
        
        .summary-point {
            margin-bottom: 0.5rem;
            padding-left: 1rem;
            position: relative;
        }
        
        .summary-point:before {
            content: "•";
            position: absolute;
            left: 0;
            right: 0;
            color: #4299e1;
        }
    </style>
</head>
<body class="bg-gray-50 flex flex-col min-h-screen">
    <!-- Top Navigation Bar -->
    <header class="bg-white shadow-sm">
        <div class="flex items-center justify-between px-6 py-3">
            <div class="flex items-center">
                <button id="menuToggle" class="md:hidden mr-4 text-gray-600">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                    </svg>
                </button>
                <div class="flex items-center">
                    <div class="w-10 h-10 rounded-full bg-blue-600 flex items-center justify-center text-white font-bold">KM</div>
                    <h1 class="ml-3 text-xl font-semibold text-gray-800">Kochi Metro Documents</h1>
                </div>
            </div>
            <div class="flex items-center">
                <div class="relative mr-4">
                    <input type="text" placeholder="Search files..." class="pl-10 pr-4 py-2 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-400 absolute left-3 top-2.5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                    </svg>
                </div>
                <div class="w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center text-gray-700 font-bold">U</div>
            </div>
        </div>
    </header>

    <div class="flex flex-1 overflow-hidden">
        <!-- Sidebar -->
        <aside class="sidebar bg-white shadow-md">
            <nav class="p-4">
                <div class="mb-8">
                    <div id="uploadArea" >
                    <button class="w-full flex items-center justify-between bg-blue-100 text-blue-700 font-medium py-3 px-4 rounded-lg">
                        <span>New Upload</span>
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd" />
                        </svg>
                        
                    <input type="file" id="fileInput" class="hidden">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-gray-400 mx-auto mb-3" fill="none"></svg>
                    </svg>
                    </button>
                </div>
                
                <ul class="space-y-2">
                    <li class="font-medium text-gray-500 text-xs uppercase tracking-wider pl-2 mb-2">Main</li>
                    <li>
                        <a href="#" class="flex items-center px-4 py-2 text-gray-700 bg-blue-50 rounded-lg">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-3 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z" />
                            </svg>
                            My Drive
                        </a>
                    </li>
                    
                </ul>
                
                <ul class="mt-8 space-y-2">
                    <li class="font-medium text-gray-500 text-xs uppercase tracking-wider pl-2 mb-2">Departments</li>
                    <li>
                        <a href="#" class="flex items-center px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg">
                            <div class="w-3 h-3 rounded-full bg-red-500 mr-3"></div>
                            Safety Reports
                        </a>
                    </li>
                    <li>
                        <a href="#" class="flex items-center px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg">
                            <div class="w-3 h-3 rounded-full bg-green-500 mr-3"></div>
                            Invoices
                        </a>
                    </li>
                    <li>
                        <a href="#" class="flex items-center px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg">
                            <div class="w-3 h-3 rounded-full bg-blue-500 mr-3"></div>
                            Engineering Drawings
                        </a>
                    </li>
                    <li>
                        <a href="#" class="flex items-center px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg">
                            <div class="w-3 h-3 rounded-full bg-yellow-500 mr-3"></div>
                            Urgent
                        </a>
                    </li>
                    <li>
                        <a href="#" class="flex items-center px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg">
                            <div class="w-3 h-3 rounded-full bg-gray-500 mr-3"></div>
                            Miscellaneous
                        </a>
                    </li>
                </ul>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content overflow-y-auto p-6">
            <div class="mb-6">
                <h2 class="text-2xl font-bold text-gray-800">Welcome to Kochi Metro Document Hub</h2>
                <p class="text-gray-600">Upload, organize, and manage your documents efficiently</p>
            </div>

            <!-- Upload Section -->
            <div class="bg-white rounded-xl shadow-sm p-6 mb-8">
                <h3 class="text-lg font-semibold text-gray-800 mb-4">Upload New File</h3>
                <div id="uploadArea" class="upload-area rounded-lg p-8 text-center cursor-pointer mb-4">
                    <input type="file" id="fileInput" class="hidden">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 text-gray-400 mx-auto mb-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
                    </svg>
                    <p class="text-gray-600">Drag and drop files here or <span class="text-blue-600 font-medium">browse files</span></p>
                    <p class="text-sm text-gray-500 mt-2">Supported formats: PDF, DOCX, PPTX, TXT (Max 10MB)</p>
                </div>

                <!-- File Preview and Summary Section (Initially Hidden) -->
                <div id="previewSection" class="hidden mt-8">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">File Analysis</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Left Column: File Preview -->
                        <div class="bg-gray-50 rounded-lg p-4">
                            <h4 class="font-medium text-gray-700 mb-3">File Preview</h4>
                            <div id="filePreview" class="p-4 bg-white rounded-lg shadow-sm h-64 overflow-y-auto">
                                <!-- Preview content will be inserted here -->
                            </div>
                        </div>
                        
                        <!-- Right Column: Summary -->
                        <div class="bg-gray-50 rounded-lg p-4">
                            <h4 class="font-medium text-gray-700 mb-3">AI Analysis</h4>
                            <div id="summaryContent" class="p-4 bg-white rounded-lg shadow-sm h-64 overflow-y-auto">
                                <!-- Summary content will be inserted here -->
                            </div>
                            <div class="mt-4 flex justify-end">
                                <button id="downloadPdf" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                                    </svg>
                                    Download Detailed PDF Report
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Suggested Files Section -->
            <div class="bg-white rounded-xl shadow-sm p-6">
                <h3 class="text-lg font-semibold text-gray-800 mb-4">Suggested Files</h3>
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead>
                            <tr>
                                <th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Name</th>
                                <th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Reason suggested</th>
                                <th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Owner</th>
                                <th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Location</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200">
                            <tr class="department-safety hover:bg-gray-50">
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <div class="flex items-center">
                                        <div class="flex-shrink-0 h-10 w-10 bg-red-100 rounded-lg flex items-center justify-center">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-red-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                                            </svg>
                                        </div>
                                        <div class="ml-4">
                                            <div class="text-sm font-medium text-gray-900">safety_report.pdf</div>
                                            <div class="text-sm text-gray-500">PDF, 2.4 MB</div>
                                        </div>
                                    </div>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <div class="text-sm text-gray-900">Rohan Luckose created • 1:45 PM</div>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                    Rohan Luckose
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                    Safety Requirements
                                </td>
                            </tr>
                            <tr class="hover:bg-gray-50">
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <div class="flex items-center">
                                        <div class="flex-shrink-0 h-10 w-10 bg-blue-100 rounded-lg flex items-center justify-center">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" />
                                            </svg>
                                        </div>
                                        <div class="ml-4">
                                            <div class="text-sm font-medium text-gray-900">VID20241103124503.mp4</div>
                                            <div class="text-sm text-gray-500">MP4, 14.7 MB</div>
                                        </div>
                                    </div>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <div class="text-sm text-gray-900">You opened • 2:32 PM</div>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                    me
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                    My Drive
                                </td>
                            </tr>
                            <tr class="department-engineering hover:bg-gray-50">
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <div class="flex items-center">
                                        <div class="flex-shrink-0 h-10 w-10 bg-blue-100 rounded-lg flex items-center justify-center">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                                            </svg>
                                        </div>
                                        <div class="ml-4">
                                            <div class="text-sm font-medium text-gray-900">road-safety-audit-kochi-metro.pdf</div>
                                            <div class="text-sm text-gray-500">PDF, 5.2 MB</div>
                                        </div>
                                    </div>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <div class="text-sm text-gray-900">You uploaded • 2:34 PM</div>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                    me
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                    My Drive
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </main>
    </div>

    <script>
        // DOM Elements
        const menuToggle = document.getElementById('menuToggle');
        const sidebar = document.querySelector('.sidebar');
        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');
        const previewSection = document.getElementById('previewSection');
        const filePreview = document.getElementById('filePreview');
        const summaryContent = document.getElementById('summaryContent');
        const downloadPdfBtn = document.getElementById('downloadPdf');

        // Toggle sidebar on mobile
        menuToggle.addEventListener('click', () => {
            sidebar.classList.toggle('active');
        });

        // Upload area functionality
        uploadArea.addEventListener('click', () => {
            fileInput.click();
        });

        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        });

        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('dragover');
        });

        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            if (e.dataTransfer.files.length) {
                handleFileUpload(e.dataTransfer.files[0]);
            }
        });

        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length) {
                handleFileUpload(e.target.files[0]);
            }
        });

        // Handle file upload and analysis
        function handleFileUpload(file) {
            if (!file) return;
            
            // Show loading state
            filePreview.innerHTML = `
                <div class="flex items-center justify-center h-full">
                    <div class="text-center">
                        <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"></div>
                        <p class="mt-4 text-gray-600">Loading file preview...</p>
                    </div>
                </div>
            `;
            
            summaryContent.innerHTML = `
                <div class="flex items-center justify-center h-full">
                    <div class="text-center">
                        <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"></div>
                        <p class="mt-4 text-gray-600">Analyzing document...</p>
                    </div>
                </div>
            `;
            
            previewSection.classList.remove('hidden');
            
            // Scroll to preview section
            previewSection.scrollIntoView({ behavior: 'smooth' });
            
            // Simulate API call delay
            setTimeout(() => {
                // Display file preview based on type
                if (file.type === 'application/pdf') {
                    filePreview.innerHTML = `
                        <div class="text-center py-8">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 text-red-500 mx-auto mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                            </svg>
                            <h3 class="font-semibold text-lg text-gray-800">${file.name}</h3>
                            <p class="text-gray-600">PDF Document</p>
                            <p class="text-sm text-gray-500 mt-2">${(file.size / 1024 / 1024).toFixed(2)} MB</p>
                        </div>
                    `;
                } else if (file.type.startsWith('image/')) {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        filePreview.innerHTML = `
                            <div class="text-center">
                                <img src="${e.target.result}" alt="${file.name}" class="max-h-52 mx-auto rounded-lg">
                                <h3 class="font-semibold text-lg text-gray-800 mt-4">${file.name}</h3>
                                <p class="text-gray-600">Image File</p>
                            </div>
                        `;
                    };
                    reader.readAsDataURL(file);
                } else {
                    filePreview.innerHTML = `
                        <div class="text-center py-8">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 text-gray-500 mx-auto mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                            </svg>
                            <h3 class="font-semibold text-lg text-gray-800">${file.name}</h3>
                            <p class="text-gray-600">Document</p>
                            <p class="text-sm text-gray-500 mt-2">${(file.size / 1024 / 1024).toFixed(2)} MB</p>
                        </div>
                    `;
                }
                
                // Simulate AI analysis based on filename and type
                simulateAnalysis(file);
            }, 2000);
        }

        // Simulate AI analysis
        function simulateAnalysis(file) {
            let department = "General Administration";
            let keywords = [];
            let summaryPoints = [];
            let detailedSummary = "";
            
            // Simple logic to determine department based on filename
            if (file.name.toLowerCase().includes('safety')) {
                department = "Safety Department";
                keywords = ["safety", "audit", "protocol", "compliance", "incident", "prevention"];
                summaryPoints = [
                    "Safety audit conducted for all metro stations and facilities",
                    "Identified 12 critical areas requiring immediate attention",
                    "Incident reports show 23% reduction in safety violations",
                    "New safety protocols implemented for electrical systems",
                    "Emergency response time improved by 18%",
                    "Staff training completion rate at 92% across all departments",
                    "Recommendations for additional safety signage at 5 stations",
                    "Quarterly safety drills scheduled for next fiscal year"
                ];
                detailedSummary = `This comprehensive safety audit report for Kochi Metro covers all operational aspects including station safety, train operations, and construction site compliance with national safety standards. The audit was conducted over a period of three months and involved detailed inspections of all 24 metro stations, maintenance facilities, and ongoing construction sites.

Key findings indicate significant improvements in overall safety compliance compared to the previous year, with a notable 23% reduction in safety violations. However, the audit identified 12 critical areas that require immediate attention, particularly in electrical systems and emergency evacuation procedures.

The report includes detailed recommendations for addressing these issues, including the implementation of enhanced safety protocols, additional staff training programs, and infrastructure improvements. A timeline of 6 months has been proposed for implementing all critical recommendations.

The audit also praises the 18% improvement in emergency response times and the 92% staff training completion rate, while suggesting measures to achieve 100% compliance in training programs.`;
            } else if (file.name.toLowerCase().includes('financial') || file.name.toLowerCase().includes('budget')) {
                department = "Finance Department";
                keywords = ["financial", "budget", "expenditure", "revenue", "forecast", "investment"];
                summaryPoints = [
                    "Q3 revenue exceeded projections by 8.2%",
                    "Operational expenses 5% under budget",
                    "Ticket sales revenue increased by 12% year-over-year",
                    "Advertising revenue reached ₹4.5 crore",
                    "Maintenance costs increased by 7% due to new stations",
                    "Capital expenditure approved for Phase 2 expansion",
                    "Profit margin improved to 18.3% from 15.6%",
                    "FY2024 budget forecast projects 15% growth"
                ];
                detailedSummary = `This financial report provides a comprehensive overview of Kochi Metro's financial performance for the third quarter of the fiscal year. The report highlights that revenue has exceeded projections by 8.2%, primarily driven by a 12% increase in ticket sales and strong performance in advertising revenue, which reached ₹4.5 crore.

Operational expenses were maintained at 5% under budget, demonstrating effective cost management despite the challenges of operating new stations. However, maintenance costs saw a 7% increase due to the addition of five new stations to the network.

The report includes detailed budget allocations for the upcoming Phase 2 expansion, with capital expenditure approved by the board. Profit margins have improved significantly from 15.6% to 18.3%, reflecting improved operational efficiency.

The FY2024 budget forecast projects a 15% growth in overall revenue, with strategic investments planned in digital infrastructure and customer experience enhancements.`;
            } else if (file.name.toLowerCase().includes('construction') || file.name.toLowerCase().includes('design')) {
                department = "Engineering Department";
                keywords = ["construction", "design", "blueprint", "infrastructure", "timeline", "materials"];
                summaryPoints = [
                    "Phase 2 expansion includes 8 new stations",
                    "Construction timeline set for 28 months completion",
                    "90% of land acquisition completed for new routes",
                    "Sustainable building materials selected for all stations",
                    "Accessibility features exceed national standards",
                    "Tunnel boring progress at 42% completion",
                    "Structural design approved for earthquake zone compliance",
                    "Integration with multi-modal transport hub planned"
                ];
                detailedSummary = `This engineering document outlines the detailed plans for Kochi Metro's Phase 2 expansion, which includes the construction of 8 new stations and extending the current network by 15.2 kilometers. The project timeline is set for completion in 28 months, with progress already at 15% since groundbreaking six months ago.

The report highlights that 90% of land acquisition has been completed for the new routes, with remaining acquisitions expected to be finalized within the next quarter. Sustainable building materials have been selected for all stations, aiming for LEED certification for at least 5 of the 8 new stations.

Notably, the accessibility features designed for the new stations exceed national standards, with provisions for visually impaired, mobility challenged, and elderly passengers. Tunnel boring progress is currently at 42% completion, ahead of schedule by approximately three weeks.

The structural design has been approved for compliance with earthquake zone requirements, with additional safety factors incorporated beyond minimum requirements. The expansion also includes plans for integration with a multi-modal transport hub, facilitating seamless connectivity with other transportation options.`;
            } else if (file.name.toLowerCase().includes('public') || file.name.toLowerCase().includes('press')) {
                department = "Public Relations Department";
                keywords = ["public", "announcement", "press", "communication", "campaign", "outreach"];
                summaryPoints = [
                    "Press kit prepared for Phase 2 launch event",
                    "Media outreach to 45+ publications and channels",
                    "Social media campaign reached 2.1 million impressions",
                    "Community feedback sessions scheduled at 6 locations",
                    "Multilingual materials created in Malayalam, English, and Hindi",
                    "Stakeholder interviews arranged with key personnel",
                    "Crisis communication protocol updated and tested",
                    "Positive sentiment analysis shows 87% favorable coverage"
                ];
                detailedSummary = `This public relations document comprises the comprehensive press kit and communication strategy for the upcoming launch of Kochi Metro's Phase 2 expansion. The kit includes key messaging, spokesperson biographies, press conference schedules, and media contact information.

The PR campaign has already secured media outreach to over 45 publications and channels, including national newspapers, local media, and industry-specific publications. The accompanying social media campaign has achieved 2.1 million impressions in the pre-launch phase, with engagement rates exceeding industry benchmarks.

Community feedback sessions have been scheduled at six locations along the new route to address public concerns and gather input. All materials have been created in three languages: Malayalam, English, and Hindi, to ensure comprehensive coverage of Kochi's diverse population.

The document also includes updated crisis communication protocols that have been tested through simulation exercises. Sentiment analysis of recent media coverage shows 87% favorable coverage, indicating strong public support for the expansion project.`;
            } else {
                keywords = ["general", "administration", "operations", "management", "policy", "procedures"];
                summaryPoints = [
                    "Updated operational guidelines for all departments",
                    "New HR policies implemented effective next quarter",
                    "IT infrastructure upgrade scheduled for Q2",
                    "Vendor management procedures streamlined",
                    "Document retention policy revised per new regulations",
                    "Inter-departmental communication protocols established",
                    "Performance metrics updated to align with organizational goals",
                    "Compliance checklist created for audit preparation"
                ];
                detailedSummary = `This general administration document outlines updated operational guidelines and policy changes affecting all departments within Kochi Metro. The comprehensive update includes revisions to HR policies, which will become effective next quarter, and details regarding the scheduled IT infrastructure upgrade in Q2.

Significant improvements have been made in vendor management procedures, reducing processing time by approximately 30% while maintaining compliance standards. The document retention policy has been revised to align with new regulatory requirements, with implementation scheduled over a six-month transition period.

The document establishes new inter-departmental communication protocols designed to improve coordination between operational units and support functions. Performance metrics have been updated to better align with organizational goals, focusing on both efficiency and customer satisfaction indicators.

A comprehensive compliance checklist has been created to facilitate audit preparation, with department-specific requirements clearly outlined. These administrative improvements are expected to enhance operational efficiency while maintaining rigorous compliance standards.`;
            }
            
            // Display the analysis results with concise bullet points
            summaryContent.innerHTML = `
                <div>
                    <h4 class="font-semibold text-gray-800 mb-2">Key Points</h4>
                    <div class="text-sm text-gray-600 mb-4">
                        ${summaryPoints.map(point => `<div class="summary-point">${point}</div>`).join('')}
                    </div>
                    
                    <h4 class="font-semibold text-gray-800 mb-2">Keywords</h4>
                    <div class="flex flex-wrap gap-2 mb-4">
                        ${keywords.map(keyword => `<span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full">${keyword}</span>`).join('')}
                    </div>
                    
                    <h4 class="font-semibold text-gray-800 mb-2">Assigned Department</h4>
                    <p class="text-gray-600">${department}</p>
                </div>
            `;
            
            // Set up PDF download with detailed summary
            setupPdfDownload(file.name, summaryPoints, detailedSummary, department, keywords);
        }

        // Set up PDF download functionality
        function setupPdfDownload(filename, summaryPoints, detailedSummary, department, keywords) {
            downloadPdfBtn.onclick = () => {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();
                
                // Add logo and header
                doc.setFillColor(37, 99, 235);
                doc.rect(0, 0, 220, 30, 'F');
                doc.setFontSize(20);
                doc.setTextColor(255, 255, 255);
                doc.text('Kochi Metro Rail Limited', 105, 17, { align: 'center' });
                doc.setFontSize(12);
                doc.text('Document Analysis Report', 105, 24, { align: 'center' });
                
                // Document information
                doc.setFontSize(14);
                doc.setTextColor(0, 0, 0);
                doc.text(`File: ${filename}`, 14, 45);
                doc.setFontSize(10);
                doc.setTextColor(100, 100, 100);
                doc.text(`Generated on: ${new Date().toLocaleDateString()}`, 14, 52);
                
                // Summary section
                doc.setFontSize(16);
                doc.setTextColor(37, 99, 235);
                doc.text('Executive Summary', 14, 65);
                doc.setDrawColor(37, 99, 235);
                doc.line(14, 67, 80, 67);
                
                doc.setFontSize(11);
                doc.setTextColor(0, 0, 0);
                let yPosition = 75;
                
                summaryPoints.forEach(point => {
                    if (yPosition > 250) {
                        doc.addPage();
                        yPosition = 20;
                    }
                    doc.text('• ' + point, 16, yPosition);
                    yPosition += 7;
                });
                
                // Detailed analysis section
                if (yPosition > 220) {
                    doc.addPage();
                    yPosition = 20;
                } else {
                    yPosition += 10;
                }
                
                doc.setFontSize(16);
                doc.setTextColor(37, 99, 235);
                doc.text('Detailed Analysis', 14, yPosition);
                doc.line(14, yPosition + 2, 80, yPosition + 2);
                
                doc.setFontSize(11);
                doc.setTextColor(0, 0, 0);
                yPosition += 10;
                
                const splitText = doc.splitTextToSize(detailedSummary, 180);
                doc.text(splitText, 14, yPosition);
                
                // Department and keywords section
                const pageHeight = doc.internal.pageSize.height;
                doc.setFontSize(16);
                doc.setTextColor(37, 99, 235);
                doc.text('Metadata', 14, pageHeight - 60);
                doc.line(14, pageHeight - 58, 50, pageHeight - 58);
                
                doc.setFontSize(11);
                doc.setTextColor(0, 0, 0);
                doc.text(`Assigned Department: ${department}`, 14, pageHeight - 50);
                doc.text(`Keywords: ${keywords.join(', ')}`, 14, pageHeight - 43);
                
                // Footer
                doc.setFontSize(10);
                doc.setTextColor(100, 100, 100);
                doc.text('Kochi Metro Rail Limited - Document Management System', 105, pageHeight - 10, { align: 'center' });
                
                // Save the PDF
                doc.save(`KM_Report_${filename.split('.')[0]}.pdf`);
            };
        }
    </script>
</body>
</html>